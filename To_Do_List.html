<!DOCTYPE html>
<html>
<head>
    <title>My To Do List</title>
    <script
  src="https://code.jquery.com/jquery-1.12.4.js"
  integrity="sha256-Qw82+bXyGq6MydymqBxNPYTaUXXq7c8v3CwiYwLLNXU="
  crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.5/dist/umd/popper.min.js" integrity="sha384-Xe+8cL9oJa6tN/veChSP7q+mnSPaj5Bcu9mPX5F5xIGE0DVittaqT5lorf0EI7Vk" crossorigin="anonymous">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.min.js" integrity="sha384-kjU+l4N0Yf4ZOJErLsIcvOU2qSb74wXpOhqTvwVx3OElZRweTnQ6d31fXEoRD1Jy" crossorigin="anonymous">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <script type="text/javascript">
    
    function _excelDown(fileName, sheetName, sheetHtml) {
        var html = '';
        html += '<html xmlns:x="urn:schemas-microsoft-com:office:excel">';
        html += '    <head>';
        html += '        <meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8">';
        html += '        <xml>';
        html += '            <x:ExcelWorkbook>';
        html += '                <x:ExcelWorksheets>';
        html += '                    <x:ExcelWorksheet>'
        html += '                        <x:Name>' + sheetName + '</x:Name>';  
        html += '                        <x:WorksheetOptions><x:Panes></x:Panes></x:WorksheetOptions>';
        html += '                    </x:ExcelWorksheet>';
        html += '                </x:ExcelWorksheets>';
        html += '            </x:ExcelWorkbook>';
        html += '        </xml>';
        html += '    </head>';
        html += '    <body>';
        
        html += sheetHtml;
        
        html += '    </body>';
        html += '</html>';
        
        var data_type = 'data:application/vnd.ms-excel';
        var ua = window.navigator.userAgent;
        var blob = new Blob([html], {type: "application/csv;charset=utf-8;"});
        
        if ((ua.indexOf("MSIE ") > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./)) && window.navigator.msSaveBlob) {
            navigator.msSaveBlob(blob, fileName);
        } else {
            var anchor = window.document.createElement('a');
            anchor.href = window.URL.createObjectURL(blob);
            anchor.download = fileName;
            document.body.appendChild(anchor);
            anchor.click();
            document.body.removeChild(anchor);
        }
    }

    function download(){
        var table = document.getElementById("mytable");
        
        if(table){
            _excelDown("My_To_Do_List.xls", "to_do_list", table.outerHTML);
        }
    }
    </script>
    <script>
        function rowAdd(){
            if($('#Title').val()==''){
              //alert("Error: check input datas");
              Swal.fire({
                  icon: 'error',
                  title: 'Error',
                  text: 'Check input datas',
                });
              $('#Title').focus();
              return false;
            }
            if($('#Content').val()==''){
              //alert("Error: check input datas");
              $('#Content').focus();
              Swal.fire({
                  icon: 'error',
                  title: 'Error',
                  text: 'Check input datas',
                });
              return false;
            }
            if($("#mytable td:eq("+46+")").html()!= ''){
              //alert("더 이상 추가할 수 없음");
              Swal.fire({
                  icon: 'error',
                  title: 'Error',
                  text: '더 이상 추가할 수 없음',
                });
              return false;
            }
            var table_value = new Array();
            var trCnt = $('#mytable tr').length-1;
            var time = new Date();
            time = time.getFullYear() + "-" + (time.getMonth()+1) + "-" + time.getDate() + " " + time.getHours() + ":" + time.getMinutes();
            var title = $("#Title").val();
            var content = $("#Content").val();
            var innerHtml = "<button><img src='https://cdn.icon-icons.com/icons2/37/PNG/512/delete_4219.png' onclick='selectDelete(this)' width='15' height='15'></button>";
            var tr_length = $('#mytable tr').length-1; //맨위 테이블 제외
            var tab_td = $('#mytable td'); // mytable의 td들 불러오기
            for(var i=0;i<tab_td.length;i++){
              if(i%5==1){
                if($("#mytable td:eq("+i+")").html()== ''){
                  $("#mytable td:eq("+i+")").html(title);
                  $("#mytable td:eq("+(i+1)+")").html(content);
                  $("#mytable td:eq("+(i+2)+")").html(time);
                  $("#mytable td:eq("+(i+3)+")").html(innerHtml);
                  break;
                }
              }
            }
        }
            
        
        function rowDelete(){
            $('#mytable tbody tr').remove();
            var innerHtml = "";
            for(var i=1;i<11;i++){
              innerHtml += '<tr><td>'+i+'</td><td></td><td></td><td></td><td></td></tr>';
            }
            $('#mytable > tbody:last').append(innerHtml);
        
          }
        

        function selectDelete(obj){
            $(obj).parent().parent().parent().remove();
            var innerHtml = "";
            innerHtml += '<tr><td></td><td></td><td></td><td></td><td></td></tr>';
            $('#mytable > tbody:last').append(innerHtml);
            var tr_length = $('#mytable tr').length-1;
            var tab_td = $('#mytable td'); 
            for(var i=0;i<tab_td.length;i++){
              if(i%5==0){
                  $("#mytable td:eq("+i+")").html(i/5+1);
              }
            }
        }
    </script>

    <style type="text/css">
      td,th{
        text-align: center;
      }
      table{
        width: 80%;
      }
      
    </style>
</head>
<body>
<h2>My To Do List</h2>
<div>add your to-do List</div>
<br>
<div style="float:left; margin-right:120px;"">
  <label class="col-sm-2 col-form-label">Title</label>
</div>
<div style="float:left;">
<input type="text" class="form-control" id="Title" size="226" placeholder="Leave a title here">
</div>    
</div>
<br><br>
<div style="float:left; margin-right:94px;"">
  <label class="col-sm-2 col-form-label">Content</label>
</div>
<div style="float:left;">
  <textarea id="Content" class="form-control" rows="2" cols="228" placeholder="Leave a content here"></textarea>
</div>
  
<br><br><br><br>
<button type="button" class="plus_to_do btn btn-primary" onclick="rowAdd()">plus_to_do</button>
<input type="button" class="btn btn-info" value="download to excel" onclick="download();"/>
<button type="button" class="clear btn btn-danger" onclick="rowDelete()" style="float: right;">clear</button>
</div>
<br>
<div>
    <table id="mytable" class="table table-borderless table-striped table table-sm" width="70%" align="center">
        <thead style="border-bottom: solid 2px;">
          <tr>
            <th>No</th>
            <th>Title</th> 
            <th>Content</th>
            <th>Date of regiser</th>
            <th>Delete</th>
          </tr>
        </thead>
        <tbody class="table-group-divider">
            <tr>
              <td>1</td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td>2</td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td>3</td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td>4</td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td>5</td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td>6</td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td>7</td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td>8</td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td>9</td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td>10</td>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
             
        </tbody>
    </table>
</div>
</body>
</html>